## HAL库模板

![1721808170563](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721808170563.png)

![1721808810884](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721808810884.png)

### 1.新建文件夹

![1721808309399](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721808309399.png)

![1721808944089](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721808944089.png)

### 2.Drivers

![1721808409784](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721808409784.png)

#### BSP

![1721809007169](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721809007169.png)



#### CMSIS

![1721809502815](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721809502815.png)

```
Device		复制的HAL官方固件库的Device下CMSIS的Device文件夹	文件夹下ST\STM32F1xx文件夹中只保留了Include和		Source文件夹
```

![1721809711787](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721809711787.png)

```
Include		里面包含了6个文件	可以通过新建HAL工程搜索工程中，复制这6个文件到这里

cmsis_armcc.h
cmsis_armclang.h
cmsis_compiler.h
cmsis_version.h
core_cm3.h
mpu_armv7.h

也可以再工程目录下的\Drivers\CMSIS\Include中找
```

![1721809732589](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721809732589.png)

![1721809968816](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721809968816.png)

![1721810066423](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810066423.png)

![1721810093699](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810093699.png)

![1721810113755](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810113755.png)

#### STM32F1xx_HAL_Driver

```
直接复制HAL固件包的STM32F1xx_HAL_Driver，删除其余文件/文件夹，只剩下图所示
```

![1721810182000](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810182000.png)

#### SYSTEM

这个文件是第三方提供的

![1721810772546](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810772546.png)

![1721810780899](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810780899.png)

![1721810789550](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810789550.png)

![1721810799890](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810799890.png)

### 3.其余文件夹

![1721808772740](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721808772740.png)

#### Project

直接新建一个MDK-ARM文件夹

![1721810403680](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810403680.png)

### 4.User文件

```
下图文件来源
HAL固件库的STM32Cube_FW_F1_V1.8.0\Projects\STM3210E_EVAL\Templates
Projects
STM3210E_EVAL
Templates
```

![1721810437599](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810437599.png)

![1721810532434](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810532434.png)

![1721810548196](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810548196.png)

![1721810602784](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810602784.png)

### 新建工程框架

![1721810878047](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810878047.png)

#### 目录

![1721810988593](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721810988593.png)

#### 选择芯片

![1721811020789](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721811020789.png)

#### 删除文件夹

![1721811110369](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721811110369.png)

### 工程文件添加

![1721811203674](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721811203674.png)

#### 文件结构修改

![1721811262684](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721811262684.png)

![1721811447625](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721811447625.png)

#### Startup启动文件

位置Template_HAL_LIB\Drivers\CMSIS\Device\ST\STM32F1xx\Source\Templates\arm

![1721811641311](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721811641311.png)

#### User

![1721811715598](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721811715598.png)

Template_HAL_LIB\Drivers\CMSIS\Device\ST\STM32F1xx\Source\Templates

![1721811785183](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721811785183.png)

#### Drivers/STM32F1xx_HAL_Driver	所用驱动文件用啥添加啥，也可以全选

![1721811980659](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721811980659.png)

```
stm32f1xx_hal.c		必要
stm32f1xx_hal_cortex.c	
stm32f1xx_hal_dma.c
stm32f1xx_hal_gpio.c
stm32f1xx_hal_gpio_ex.c
stm32f1xx_hal_rcc.c
stm32f1xx_hal_rcc_ex.c
stm32f1xx_hal_uart.c
stm32f1xx_hal_usart.c
```

![1721812071455](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721812071455.png)

### 只读钥匙解决

![1721812260402](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721812260402.png)

#### 解决修改文件夹属性

![1721812287980](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721812287980.png)

![1721812317828](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721812317828.png)

### 魔术棒设置

![1721812568714](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721812568714.png)



![1721812498575](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721812498575.png)

![1721812548104](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721812548104.png)

![1721894156819](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721894156819.png)

![1721812621376](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721812621376.png)

![1721812673097](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721812673097.png)

![1721813300391](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721813300391.png)

STM32F10X_MD

```
上图说明宏定义

USE_HAL_DRIVER		需要用HAL库就需要包含这个
STM32F103xB		对应芯片的不同，选择不同的宏定义
USE_HAL_DRIVER,STM32F103xB

```

![1721813586999](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721813586999.png)

![1721813602606](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721813602606.png)

![1721813722257](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721813722257.png)

![1721813821835](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721813821835.png)

![1721895610512](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721895610512.png)

![1721813955564](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721813955564.png)

![1721818880087](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721818880087.png)

![1721818947619](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721818947619.png)

![1721818956838](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721818956838.png)



![1721820121125](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721820121125.png)

![1721820350511](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721820350511.png)



![1721873828558](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721873828558.png)



### HAL库问题



![1721878531204](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721878531204.png)

![1721878614123](D:/%E7%AC%94%E8%AE%B0/MD%E6%96%87%E6%A1%A3/STM32/%E5%AF%84%E5%AD%98%E5%99%A8%E5%BC%80%E5%8F%91/assets/1721878614123.png)

